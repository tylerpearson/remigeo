(function(e,t){var n=function(){var t=e._data(document,"events");return t&&t.click&&e.grep(t.click,function(e){return e.namespace==="rails"}).length};n()&&e.error("jquery-ujs has already been loaded!");var r;e.rails=r={linkClickSelector:"a[data-confirm], a[data-method], a[data-remote], a[data-disable-with]",inputChangeSelector:"select[data-remote], input[data-remote], textarea[data-remote]",formSubmitSelector:"form",formInputClickSelector:"form input[type=submit], form input[type=image], form button[type=submit], form button:not([type])",disableSelector:"input[data-disable-with], button[data-disable-with], textarea[data-disable-with]",enableSelector:"input[data-disable-with]:disabled, button[data-disable-with]:disabled, textarea[data-disable-with]:disabled",requiredInputSelector:"input[name][required]:not([disabled]),textarea[name][required]:not([disabled])",fileInputSelector:"input[type=file]",linkDisableSelector:"a[data-disable-with]",CSRFProtection:function(t){var n=e('meta[name="csrf-token"]').attr("content");n&&t.setRequestHeader("X-CSRF-Token",n)},fire:function(t,n,r){var i=e.Event(n);return t.trigger(i,r),i.result!==!1},confirm:function(e){return confirm(e)},ajax:function(t){return e.ajax(t)},href:function(e){return e.attr("href")},handleRemote:function(n){var i,s,o,u,a,f,l,c;if(r.fire(n,"ajax:before")){u=n.data("cross-domain"),a=u===t?null:u,f=n.data("with-credentials")||null,l=n.data("type")||e.ajaxSettings&&e.ajaxSettings.dataType;if(n.is("form")){i=n.attr("method"),s=n.attr("action"),o=n.serializeArray();var h=n.data("ujs:submit-button");h&&(o.push(h),n.data("ujs:submit-button",null))}else n.is(r.inputChangeSelector)?(i=n.data("method"),s=n.data("url"),o=n.serialize(),n.data("params")&&(o=o+"&"+n.data("params"))):(i=n.data("method"),s=r.href(n),o=n.data("params")||null);c={type:i||"GET",data:o,dataType:l,beforeSend:function(e,i){return i.dataType===t&&e.setRequestHeader("accept","*/*;q=0.5, "+i.accepts.script),r.fire(n,"ajax:beforeSend",[e,i])},success:function(e,t,r){n.trigger("ajax:success",[e,t,r])},complete:function(e,t){n.trigger("ajax:complete",[e,t])},error:function(e,t,r){n.trigger("ajax:error",[e,t,r])},crossDomain:a},f&&(c.xhrFields={withCredentials:f}),s&&(c.url=s);var p=r.ajax(c);return n.trigger("ajax:send",p),p}return!1},handleMethod:function(n){var i=r.href(n),s=n.data("method"),o=n.attr("target"),u=e("meta[name=csrf-token]").attr("content"),a=e("meta[name=csrf-param]").attr("content"),f=e('<form method="post" action="'+i+'"></form>'),l='<input name="_method" value="'+s+'" type="hidden" />';a!==t&&u!==t&&(l+='<input name="'+a+'" value="'+u+'" type="hidden" />'),o&&f.attr("target",o),f.hide().append(l).appendTo("body"),f.submit()},disableFormElements:function(t){t.find(r.disableSelector).each(function(){var t=e(this),n=t.is("button")?"html":"val";t.data("ujs:enable-with",t[n]()),t[n](t.data("disable-with")),t.prop("disabled",!0)})},enableFormElements:function(t){t.find(r.enableSelector).each(function(){var t=e(this),n=t.is("button")?"html":"val";t.data("ujs:enable-with")&&t[n](t.data("ujs:enable-with")),t.prop("disabled",!1)})},allowAction:function(e){var t=e.data("confirm"),n=!1,i;return t?(r.fire(e,"confirm")&&(n=r.confirm(t),i=r.fire(e,"confirm:complete",[n])),n&&i):!0},blankInputs:function(t,n,r){var i=e(),s,o,u=n||"input,textarea",a=t.find(u);return a.each(function(){s=e(this),o=s.is("input[type=checkbox],input[type=radio]")?s.is(":checked"):s.val();if(!o==!r){if(s.is("input[type=radio]")&&a.filter('input[type=radio]:checked[name="'+s.attr("name")+'"]').length)return!0;i=i.add(s)}}),i.length?i:!1},nonBlankInputs:function(e,t){return r.blankInputs(e,t,!0)},stopEverything:function(t){return e(t.target).trigger("ujs:everythingStopped"),t.stopImmediatePropagation(),!1},callFormSubmitBindings:function(n,r){var i=n.data("events"),s=!0;return i!==t&&i.submit!==t&&e.each(i.submit,function(e,t){if(typeof t.handler=="function")return s=t.handler(r)}),s},disableElement:function(e){e.data("ujs:enable-with",e.html()),e.html(e.data("disable-with")),e.bind("click.railsDisable",function(e){return r.stopEverything(e)})},enableElement:function(e){e.data("ujs:enable-with")!==t&&(e.html(e.data("ujs:enable-with")),e.data("ujs:enable-with",!1)),e.unbind("click.railsDisable")}},r.fire(e(document),"rails:attachBindings")&&(e.ajaxPrefilter(function(e,t,n){e.crossDomain||r.CSRFProtection(n)}),e(document).delegate(r.linkDisableSelector,"ajax:complete",function(){r.enableElement(e(this))}),e(document).delegate(r.linkClickSelector,"click.rails",function(n){var i=e(this),s=i.data("method"),o=i.data("params");if(!r.allowAction(i))return r.stopEverything(n);i.is(r.linkDisableSelector)&&r.disableElement(i);if(i.data("remote")!==t){if((n.metaKey||n.ctrlKey)&&(!s||s==="GET")&&!o)return!0;var u=r.handleRemote(i);return u===!1?r.enableElement(i):u.error(function(){r.enableElement(i)}),!1}if(i.data("method"))return r.handleMethod(i),!1}),e(document).delegate(r.inputChangeSelector,"change.rails",function(t){var n=e(this);return r.allowAction(n)?(r.handleRemote(n),!1):r.stopEverything(t)}),e(document).delegate(r.formSubmitSelector,"submit.rails",function(n){var i=e(this),s=i.data("remote")!==t,o=r.blankInputs(i,r.requiredInputSelector),u=r.nonBlankInputs(i,r.fileInputSelector);if(!r.allowAction(i))return r.stopEverything(n);if(o&&i.attr("novalidate")==t&&r.fire(i,"ajax:aborted:required",[o]))return r.stopEverything(n);if(s){if(u){setTimeout(function(){r.disableFormElements(i)},13);var a=r.fire(i,"ajax:aborted:file",[u]);return a||setTimeout(function(){r.enableFormElements(i)},13),a}return!e.support.submitBubbles&&e().jquery<"1.7"&&r.callFormSubmitBindings(i,n)===!1?r.stopEverything(n):(r.handleRemote(i),!1)}setTimeout(function(){r.disableFormElements(i)},13)}),e(document).delegate(r.formInputClickSelector,"click.rails",function(t){var n=e(this);if(!r.allowAction(n))return r.stopEverything(t);var i=n.attr("name"),s=i?{name:i,value:n.val()}:null;n.closest("form").data("ujs:submit-button",s)}),e(document).delegate(r.formSubmitSelector,"ajax:beforeSend.rails",function(t){this==t.target&&r.disableFormElements(e(this))}),e(document).delegate(r.formSubmitSelector,"ajax:complete.rails",function(t){this==t.target&&r.enableFormElements(e(this))}),e(function(){var t=e("meta[name=csrf-token]").attr("content"),n=e("meta[name=csrf-param]").attr("content");e('form input[name="'+n+'"]').val(t)}))})(jQuery),function(e){e.a=function(t,n){var r=t.split(".")[0];t=t.split(".")[1],e[r]=e[r]||{},e[r][t]=function(e,t){arguments.length&&this._setup(e,t)},e[r][t].prototype=e.extend({namespace:r,pluginName:t},n),e.fn[t]=function(n){var i=typeof n=="string",s=Array.prototype.slice.call(arguments,1),o=this;return i&&n.substring(0,1)==="_"?o:(this.each(function(){var u=e.data(this,t);u||(u=e.data(this,t,new e[r][t](n,this)));if(i){var a=u[n].apply(u,s);if(n==="get"||a!=null)o=a}}),o)}},e.a("ui.gmap",{options:{mapTypeId:"roadmap",zoom:5},option:function(e,t){if(t){this.options[e]=t,this.get("map").set(e,t);return}return this.options[e]},_setup:function(e,t){this.el=t,e=e||{},jQuery.extend(this.options,e,{center:this._latLng(e.center)}),this._create(),this._init&&this._init()},_create:function(){var t=this;this.instance={map:new google.maps.Map(t.el,t.options),markers:[],overlays:[],services:[]},google.maps.event.addListenerOnce(t.instance.map,"bounds_changed",function(){e(t.el).trigger("init",t.instance.map)}),t._call(t.options.callback,t.instance.map)},addBounds:function(e){var t=this.get("bounds",new google.maps.LatLngBounds);t.extend(this._latLng(e)),this.get("map").fitBounds(t)},inViewport:function(e){var t=this.get("map").getBounds();return t?t.contains(e.getPosition()):!1},addControl:function(e,t){this.get("map").controls[t].push(this._unwrap(e))},addMarker:function(t,n){t.map=this.get("map"),t.position=this._latLng(t.position);var r=new(t.marker||google.maps.Marker)(t),i=this.get("markers");return r.id?i[r.id]=r:i.push(r),r.bounds&&this.addBounds(r.getPosition()),this._call(n,t.map,r),e(r)},clear:function(e){this._c(this.get(e)),this.set(e,[])},_c:function(e){for(var t in e)e.hasOwnProperty(t)&&(e[t]instanceof google.maps.MVCObject?(google.maps.event.clearInstanceListeners(e[t]),e[t].setMap&&e[t].setMap(null)):e[t]instanceof Array&&this._c(e[t]),e[t]=null)},find:function(t,n,r){var i=this.get(t);n.value=e.isArray(n.value)?n.value:[n.value];for(var s in i)if(i.hasOwnProperty(s)){var o=!1;for(var u in n.value)if(e.inArray(n.value[u],i[s][n.property])>-1)o=!0;else if(n.operator&&n.operator==="AND"){o=!1;break}r(i[s],o)}},get:function(e,t){var n=this.instance;if(!n[e]){if(e.indexOf(">")>-1){var r=e.replace(/ /g,"").split(">");for(var i=0;i<r.length;i++){if(!n[r[i]]){if(!t)return null;n[r[i]]=i+1<r.length?[]:t}n=n[r[i]]}return n}t&&!n[e]&&this.set(e,t)}return n[e]},openInfoWindow:function(e,t,n){var r=this.get("iw",e.infoWindow||new google.maps.InfoWindow);r.setOptions(e),r.open(this.get("map"),this._unwrap(t)),this._call(n,r)},closeInfoWindow:function(){this.get("iw")!=null&&this.get("iw").close()},set:function(e,t){this.instance[e]=t},refresh:function(){var t=this.get("map"),n=t.getCenter();e(t).triggerEvent("resize"),t.setCenter(n)},destroy:function(){this.clear("markers"),this.clear("services"),this.clear("overlays"),this._c(this.instance),jQuery.removeData(this.el,this.name)},_call:function(t){t&&e.isFunction(t)&&t.apply(this,Array.prototype.slice.call(arguments,1))},_latLng:function(e){return e?e instanceof google.maps.LatLng?e:(e=e.replace(/ /g,"").split(","),new google.maps.LatLng(e[0],e[1])):new google.maps.LatLng(0,0)},_unwrap:function(t){return t?t instanceof jQuery?t[0]:t instanceof Object?t:e("#"+t)[0]:null}}),jQuery.fn.extend({triggerEvent:function(e){return google.maps.event.trigger(this[0],e),this},addEventListener:function(e,t,n){return google.maps&&this[0]instanceof google.maps.MVCObject?google.maps.event.addListener(this[0],e,t):n?this.bind(e,t,n):this.bind(e,t),this},removeEventListener:function(e){return google.maps&&this[0]instanceof google.maps.MVCObject?e?google.maps.event.clearListeners(this[0],e):google.maps.event.clearInstanceListeners(this[0]):this.unbind(e),this}}),jQuery.each("click rightclick dblclick mouseover mouseout drag dragend".split(" "),function(e,t){jQuery.fn[t]=function(e,n){return this.addEventListener(t,e,n)}})}(jQuery),function(){var e,t,n,r,i,s;t="DHICGNZEQLALXKHTWVSQPBRJPDAUSSTP5U1WAHDT5YAUITUL",n="QJJOUTWQ2RBIMQJ3ED3RWZBIDGG4ZLEXK3LJQSM3LGU4KOON",$(document).ready(function(){var t,n,i,o;return navigator.geolocation?(n=0,i=0,o=void 0,navigator.geolocation.getCurrentPosition(function(e){return o=e,n=o.coords.latitude,i=o.coords.longitude},function(e){return e.code===1?alert("You need to share your location!"):alert("Hmm, something went wrong, please try again.")}),$(".get-nearby").on("click",function(t){return t.preventDefault(),r(n,i),$(".results-container").fadeIn(250),$(".search-locations-container").hide(),$(".nearby-locations-container").fadeIn(),e(),$(this).toggleClass("toggled")}),$(".search-locations").on("click",function(t){return t.preventDefault(),$(".results-container").fadeIn(250),e(),$(this).toggleClass("toggled"),$(".nearby-locations-container").hide(),$(".search-locations-container").fadeIn()}),$("#location-search").on("keyup",function(e){var t;t=$("#location-search").val();if(t.length>2)return $("#search-locations-results").fadeIn(),s(t,n,i)})):alert("Please use a browser that supports geolocation"),t=$("#map-canvas"),t.gmap().bind("init",function(){return $.getJSON("/messages.json",function(e){var n,r,i,s;if(e.length){s=[];for(r=0,i=e.length;r<i;r++)n=e[r],s.push(t.gmap("addMarker",{position:new google.maps.LatLng(n.location.latitude,n.location.longitude),bounds:!0}).click(function(){return t.gmap("openInfoWindow",{content:"<b>"+n.location.title+"</b><br> "+n.content},this)}));return s}})})}),e=function(){return $(".toggled").removeClass("toggled")},s=function(e,r,i){var s,o,u;return o=new Date,s=o.yyyymmdd(),u="https://api.foursquare.com/v2/venues/suggestcompletion?ll="+r+","+i+"&query="+e+"&client_id="+t+"&client_secret="+n+"&v="+s+"&limit=50",$.getJSON(u,function(e){var t,n;return n=[],$.each(e.response.minivenues,function(e,t){return n.push('<option value="'+t.id+'">'+t.name+" ("+t.location.address+", "+t.location.city+")</option>")}),t=$("#search-locations-results"),t.html(""),{success:$(n.join("")).appendTo(t)}})},r=function(e,r){var s,o,u;return o=new Date,s=o.yyyymmdd(),u="https://api.foursquare.com/v2/venues/search?ll="+e+","+r+"&client_id="+t+"&client_secret="+n+"&v="+s+"&limit=50",$.getJSON(u,function(e){var t,n;return n=[],$.each(e.response.venues,function(e,t){return n.push('<option value="'+t.id+'">'+t.name+" ("+i(t.location.distance)+"ft)</option>")}),t=$("#nearby-locations"),{success:$(n.join("")).appendTo(t)}})},i=function(e){return Math.round(parseFloat(e*3.28084))},Date.prototype.yyyymmdd=function(){var e,t,n;return n=this.getFullYear().toString(),t=(this.getMonth()+1).toString(),e=this.getDate().toString(),n+(t[1]?t:"0"+t[0])+(e[1]?e:"0"+e[0])}}.call(this),function(){}.call(this);